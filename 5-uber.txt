import pandas as pd

df=pd.read_csv('uber.csv')

df.head()

df.isnull().sum()

df = df.dropna(axis=0)

df.isnull().sum()

df.info()

df['pickup_datetime'] = pd.to_datetime(df['pickup_datetime'])
df['hour'] = df['pickup_datetime'].dt.hour
df['month'] = df['pickup_datetime'].dt.month

df.info()

df.describe()


import seaborn as sns
import matplotlib.pyplot as plt


sns.boxplot(df['fare_amount'])
plt.title("Fare Amount Outliers")
plt.show()


sns.boxplot(df['passenger_count'])
plt.title("passenger_count Outliers")
plt.show()


import seaborn as sns
import matplotlib.pyplot as plt

sns.heatmap(corr_matrix, annot=True, cmap='coolwarm')
plt.title("Correlation Heatmap")
plt.show()

X = df[['pickup_longitude', 'pickup_latitude', 'dropoff_longitude',
        'dropoff_latitude', 'passenger_count', 'hour', 'month']]
y = df['fare_amount']

        
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=1)

from sklearn.linear_model import LinearRegression

lr = LinearRegression()
lr.fit(X_train, y_train)

y_pred_lr = lr.predict(X_test)   
print("Predicted values using Linear Regression:")
print(y_pred_lr[:10]) 


from sklearn.ensemble import RandomForestRegressor

rf = RandomForestRegressor(n_estimators=10, random_state=1)  # instead of 100 (default)
rf.fit(X_train, y_train)
y_pred_rf = rf.predict(X_test)

print("Predicted values using Random Forest:")
print(y_pred_rf[:10])


from sklearn.metrics import r2_score, mean_squared_error
import numpy as np

r2_lr = r2_score(y_test, y_pred_lr)
rmse_lr = np.sqrt(mean_squared_error(y_test, y_pred_lr))


r2_rf = r2_score(y_test, y_pred_rf)
rmse_rf = np.sqrt(mean_squared_error(y_test, y_pred_rf))


print("Linear Regression:")
print("R² Score:", r2_lr)
print("RMSE:", rmse_lr)

print("\nRandom Forest:")
print("R² Score:", r2_rf)
print("RMSE:", rmse_rf)


